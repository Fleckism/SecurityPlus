## EXAM OBJECTIVES COVERED

1.7 Summarize the techniques used in security assessments

Automated vulnerability scanning is a key part of both initial security assessment and ongoing compliance monitoring. You should be able to summarize types of scanners and explain the impact of scan configurations. You should also be able to contribute to threat hunting security assessments and explain how they can be supported by threat intelligence platforms.

## SECURITY ASSESSMENTS

Network reconnaissance and discovery is used to identify hosts, network topology, and open services/ports, establishing an overall attack surface. Various types of security assessments can be used to test these hosts and services for vulnerabilities. There are many models and frameworks for conducting security assessments. A good starting point is NIST's Technical Guide to Information Security Testing and Assessment ([nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-115.pdf](https://wmx-api-production.s3.amazonaws.com/courses/5731/supplementary/nistspecialpublication800-115.pdf)). SP 800-115 identifies three principal activities within an assessment:

-   Testing the object under assessment to discover vulnerabilities or to prove the effectiveness of security controls.
-   Examining assessment objects to understand the security system and identify any logical weaknesses. This might highlight a lack of security controls or a common misconfiguration.
-   Interviewing personnel to gather information and probe attitudes toward and understanding of security.

The main types of security assessment are usually classed as vulnerability assessment, threat hunting, and penetration testing. A vulnerability assessment is an evaluation of a system's security and ability to meet compliance requirements based on the configuration state of the system. Essentially, the vulnerability assessment determines if the current configuration matches the ideal configuration (the baseline). Vulnerability assessments might involve manual inspection of security controls, but are more often accomplished through automated vulnerability scanners.
## VULNERABILITY SCAN TYPES

An automated scanner must be configured with signatures and scripts that can correlate known software and configuration vulnerabilities with data gathered from each host. Consequently, there are several types of vulnerability scanners optimized for different tasks.

### Network Vulnerability Scanner

A network vulnerability scanner, such as Tenable Nessus ([tenable.com/products/nessus](https://www.tenable.com/products/nessus)) or OpenVAS ([openvas.org](https://www.openvas.org/)), is designed to test network hosts, including client PCs, mobile devices, servers, routers, and switches. It examines an organization's on-premises systems, applications, and devices and compares the scan results to configuration templates plus lists of known vulnerabilities. Typical results from a vulnerability assessment will identify missing patches, deviations from baseline configuration templates, and other related vulnerabilities. 

![Dashboard shows 5 graphs titled Tasks by Severity Class, Tasks by status, CVEs by creation time, Hosts topology, and NVTs by Severity Class.](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/9230-1599771795158.png)

Greenbone OpenVAS vulnerability scanner with Security Assistant web application interface as installed on Kali Linux. (Screenshot used with permission from Greenbone Networks, [http://www.openvas.org](http://www.openvas.org/).)

The first phase of scanning might be to run a detection scan to discover hosts on a particular IP subnet. In the next phase of scanning, a target range of hosts is probed to detect running services, patch level, security configuration and policies, network shares, unused accounts, weak passwords, antivirus configuration, and so on.

Each scanner is configured with a database of known software and configuration vulnerabilities. The tool compiles a report about each vulnerability in its database that was found to be present on each host. Each identified vulnerability is categorized and assigned an impact warning. Most tools also suggest remediation techniques. This information is highly sensitive, so use of these tools and the distribution of the reports produced should be restricted to authorized hosts and user accounts.

Network vulnerability scanners are configured with information about known vulnerabilities and configuration weaknesses for typical network hosts. These scanners will be able to test common operating systems, desktop applications, and some server applications. This is useful for general purpose scanning, but some types of applications might need more rigorous analysis.

### Application and Web Application Scanners

A dedicated application scanner is configured with more detailed and specific scripts to test for known attacks, as well as scanning for missing patches and weak configurations. The best known class of application scanners are web application scanners. Tools such as Nikto ([cirt.net/Nikto2](https://cirt.net/Nikto2)) look for known web exploits, such as SQL injection and cross-site scripting (XSS), and may also analyze source code and database security to detect unsecure programming practices. Other types of application scanners would be optimized for a particular class of software, such as a database server.
## COMMON VULNERABILITIES AND EXPOSURES

An automated scanner needs to be kept up to date with information about known vulnerabilities. This information is often described as a vulnerability feed, though the Nessus tool refers to these feeds as _plug-ins,_ and OpenVAS refers to them as _network vulnerability tests (NVTs)._ Often, the vulnerability feed forms an important part of scan vendors' commercial models, as the latest updates require a valid subscription to acquire.

![](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/2799-1599771795293.png)

Checking feed status in the Greenbone Community Edition vulnerability manager. (Screenshot: Greenbone Community Edition [greenbone.net/en/community-edition](https://www.greenbone.net/en/community-edition).)

Vulnerability feeds make use of common identifiers to facilitate sharing of intelligence data across different platforms. Many vulnerability scanners use the Secure Content Automation Protocol (SCAP) to obtain feed or plug-in updates ([scap.nist.gov](https://csrc.nist.gov/projects/security-content-automation-protocol/)). As well as providing a mechanism for distributing the feed, SCAP defines ways to compare the actual configuration of a system to a target-secure baseline plus various systems of common identifiers. These identifiers supply a standard means for different products to refer to a vulnerability or platform consistently.

Common Vulnerabilities and Exposures (CVE) is a dictionary of vulnerabilities in published operating systems and applications software ([cve.mitre.org](https://cve.mitre.org/)). There are several elements that make up a vulnerability's entry in the CVE:

-   An identifier in the format: CVE-YYYY-####, where YYYY is the year the vulnerability was discovered, and #### is at least four digits that indicate the order in which the vulnerability was discovered.
-   A brief description of the vulnerability.
-   A reference list of URLs that supply more information on the vulnerability.
-   The date the vulnerability entry was created.

The CVE dictionary provides the principal input for NIST's National Vulnerability Database ([nvd.nist.gov](https://nvd.nist.gov/)). The NVD supplements the CVE descriptions with additional analysis, a criticality metric, calculated using the Common Vulnerability Scoring System (CVSS), plus fix information.

CVSS is maintained by the Forum of Incident Response and Security Teams ([first.org/cvss](https://www.first.org/cvss)). CVSS metrics generate a score from 0 to 10 based on characteristics of the vulnerability, such as whether it can be triggered remotely or needs local access, whether user intervention is required, and so on. The scores are banded into descriptions too:

Score

  Description  

0.1+

Low

4.0+

Medium

7.0+

High

9.0+

Critical
## INTRUSIVE VERSUS NON-INTRUSIVE SCANNING

A network vulnerability scanner can be implemented purely as software or as a security appliance, connected to the network. Some scanners work remotely by contacting the target host over the network. Other scanner types use agents installed locally on each host to perform the scanning and transmit a report to a management server. For example, Nessus Professional allows remote scanning of hosts while Nessus Manager, and Tenable Cloud can work with locally installed agent software.

![Screenshot shows "+ New Scan" selected in navigation pane, and My Scans page with 1 entry: Agent Scan Scheduled, On Demand, January 16 (checkmarked).](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/3800-1599771795334.png)

Nessus Manager web management interface. (Screenshot used with permission from Tenable Network Security.)

_Scan intrusiveness_ is a measure of how much the scanner interacts with the target. Non-intrusive (or passive) scanning means analyzing indirect evidence, such as the types of traffic generated by a device. A passive scanner, the Zeek Network Security Monitor ([zeek.org](https://zeek.org/)) being one example, analyzes a network capture and tries to identify policy deviations or CVE matches. This type of scanning has the least impact on the network and on hosts, but is less likely to identify vulnerabilities comprehensively. Passive scanning might be used by a threat actor to scan a network stealthily. You might use passive scanning as a technique where active scanning poses a serious risk to system stability, such as scanning print devices, VoIP handsets, or embedded systems networks.

_Active scanning_ means probing the device's configuration using some sort of network connection with the target. Active scanning consumes more network bandwidth and runs the risk of crashing the target of the scan or causing some other sort of outage. Agent-based scanning is also an active technique.

The most intrusive type of vulnerability scanner does not stop at detecting a vulnerability. Exploitation frameworks contain default scripts to try to use a vulnerability to run code or otherwise gain access to the system. This type of highly intrusive testing is more typical of penetration testing than automated vulnerability scanning.