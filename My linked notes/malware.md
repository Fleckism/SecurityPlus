

Many of the intrusion attempts perpetrated against computer networks depend on the use of malicious software, or [[malware]]. _Malware_ is usually simply defined as software that does something bad, from the perspective of the system owner. There are many types of malware, but they are not classified in a rigorous way, so some definitions overlap or are blurred. Some malware classifications, such as Trojan, virus, and worm, focus on the [[vector]] used by the malware. The **vector is the method by which the malware executes on a computer and potentially spreads to other network hosts**. Another complicating factor with malware classification is the degree to which its installation is expected or tolerated by the user. The following categories describe some types of malware according to vector:

-   **[[Virus]]es and worms**—these represent some of the first types of malware and spread without any authorization from the user by being concealed within the executable code of another process.
-   **[[Trojan]]**—malware concealed within an installer package for software that appears to be legitimate. This type of malware does not seek any type of consent for installation and is actively designed to operate secretly.
-   **Potentially unwanted programs** ([[PUPs]])/**Potentially unwanted applications** ([[PUAs]])—software installed alongside a package selected by the user or perhaps bundled with a new computer system. Unlike a Trojan, the presence of a PUP is not automatically regarded as malicious. It may have been installed without active consent or consent from a purposefully confusing license agreement. This type of software is sometimes described as **grayware** rather than malware.

Other classifications are based on the payload delivered by the malware. The [[payload]] is an action performed by the malware other than simply replicating or persisting on a host. Examples of payload classifications include spyware, rootkit, remote access Trojan (RAT), and ransomware.

 [[Fileless]] is not a definitive classification, but it describes a collection of common behaviors and techniques:
 
 Ransomware is a type of malware that tries to extort money from the victim
 
 If malware is designed to operate covertly, indicators can require detailed analysis of process, file system, and network behavior.
 
 Resource Consumption: Also, it is only really poorly written malware or malware that performs intensive operations (botnet DDoS, cryptojacking, and cryptoransomware, for instance) that displays this behavior. Resource consumption could be a reason to investigate a system rather than definitive proof of infection
 
 Even if the [[malware]] code is not saved to disk, the malware is still likely to interact with the file system and registry, revealing its presence by behavior. A computer's file system stores a great deal of useful metadata about when files were created, accessed, or modified. Analyzing these metadata and checking for suspicious temporary files can help you establish your timeline of events for an incident that has left traces on a host and its files.
 
 Because shellcode is easy to obfuscate, it can often evade signature-based [[A-V]] products. Threat hunting and security monitoring must use **behavioral-based techniques** to identify infections. This means close analysis of the processes running in system memory on a host. To perform abnormal process behavior analysis effectively, you should build up a sense of what is "normal" in a system and spot deviations in a potentially infected system.
 
 **Along with observing how a process interacts with the file system, network activity is one of the most reliable ways to identify [[malware]].**
 
 [[Fileless]] 
 [[logic bomb]]
 [[PUPs]]
 [[Trojan]]
 [[virus]]
 [[worm]]
 
  Some malware classifications, such as Trojan, virus, and worm, focus on the [[vector]] used by the malware. The **vector is the method by which the malware executes on a computer and potentially spreads to other network hosts**
  
  [[payload]]
  
  # SPYWARE AND KEYLOGGERS

The first viruses and worms focused on the destructive potential of being able to replicate. As the profitable uses of this software became apparent, however, they started to be coded with payloads designed to facilitate intrusion, fraud, and data theft. Various types of unwanted code and malware perform some level of monitoring:

-   Tracking cookies—cookies are plaintext files, not malware, but if browser settings allow third-party cookies, they can be used to record pages visited, search queries, browser metadata, and IP address. Tracking cookies are created by adverts and analytics widgets embedded into many websites.
-   Adware—this is a class of [[PUPs]]/grayware that performs browser reconfigurations, such as allowing tracking cookies, changing default search providers, opening sponsor's pages at startup, adding bookmarks, and so on. Adware may be installed as a program or as a browser extension/plug-in.
-   [[Spyware]]—this is malware that can perform adware-like tracking, but also monitor local application activity, take screenshots, and activate recording devices, such as a microphone or webcam. Another spyware technique is to perform [[DNS]] redirection to pharming sites.
-   A [[keylogger]] is spyware that actively attempts to steal confidential information by recording keystrokes. The attacker will usually hope to discover passwords or credit card data.

![Screenshot of Actual Keylogger shows detail on Keystrokes tab, including actual password typed for highlighted item.](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/1811-1599771796602.png)

Actual Keylogger is a Windows-based software that can run in the background to monitor different kinds of computer activity (opening and closing programs, browsing websites, recording keystrokes, and capturing screenshots). (Screenshot used with permission from [ActualKeylogger.com](https://www.actualkeylogger.com/).)

Keyloggers are not only implemented as software. A malicious script can transmit key presses to a third-party website. There are also hardware devices to capture key presses to a modified USB adapter inserted between the keyboard and the port. Such devices can store data locally or come with Wi-Fi connectivity to send data to a covert access point. Other attacks include wireless sniffers to record key press data, overlay ATM pin pads, and so on.