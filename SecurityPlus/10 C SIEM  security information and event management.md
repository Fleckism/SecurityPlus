# EXAM OBJECTIVES COVERED
**security information and event management** [[SIEM]]
1.7 Summarize the techniques used in [[[[security assesment]]s]]

3.3 Given a scenario, #Implementation  secure network designs #A_D
#Ops
4.1 Given a scenario, use the appropriate #tool to assess organizational security

There are many types of [[security control]]s that can be deployed to protect networks, hosts, and data. One thing that all these controls have in common is that they generate log data and alerts. Reviewing this output is one of the principal challenges in information security management. As a security professional, you must be able to describe, install, and configure systems to manage logging and events.
# MONITORING SERVICES

[[security assesment]]s and incident response both require real-time monitoring of host and network status indicators plus audit information.

### Packet Capture

**Data captured** (logged traffic) from network sensors/sniffers plus netflow sources provides both summary statistics about **bandwidth and protocol usage** and the opportunity for detailed frame analysis.

### Network Monitors

As distinct from **network traffic monitoring**,(**not the same thing**) a **network monitor** collects data about **network appliances**, such as switches, access points, routers, firewalls, and servers. This is used to monitor load status for CPU/memory, state tables, disk capacity, fan speeds/temperature, network link utilization/error statistics, and so on. Another important function is a heartbeat message to indicate [[My linked notes/Dictionary/Availability]]. This data might be collected using the Simple Network Management Protocol ([[SNMP]]) or a proprietary management system. As well as supporting [[My linked notes/Dictionary/Availability]], network monitoring might reveal unusual conditions that could point to some kind of attack.

### Logs

Logs are one of the most valuable sources of security information. A system log can be used to diagnose [[My linked notes/Dictionary/Availability]] issues. A security log can record both authorized and unauthorized uses of a resource or privilege. Logs function both as an audit trail of actions and (if monitored regularly) provide a warning of intrusion attempts. Log review is a critical part of security assurance. Only referring to the logs following a major incident is missing the opportunity to identify threats and vulnerabilities early and to respond proactively. 

Logs typically associate an action with a particular user. This is one of the reasons that it is critical that users not share logon details. If a user account is compromised, there is no means of tying events in the log to the actual attacker.
# SECURITY INFORMATION AND EVENT MANAGEMENT

Software designed to assist with managing security data inputs and provide reporting and alerting is often described as security information and event management ([[SIEM]]). The core function of a SIEM tool is to aggregate traffic data and logs. In addition to logs from Windows and Linux-based hosts, this could include switches, routers, firewalls, IDS sensors, vulnerability scanners, malware scanners, data loss prevention ([[DLP]]) systems, and databases.

![Screenshot of SIEM dashboards with Security tab selected, showing the available data available.](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/7009-1599771805070.png)

OSSIM SIEM dashboard—Configurable dashboards provide the high-level status view of network security metrics. (Screenshot used with permission from AT&T Cybersecurity.)

### Log Collection 

The first task for SIEM is to collect **data inputs** from multiple sources. There are three main types of log collection:

-   **Agent-based**—with this approach, you must install an agent service on each host. As events occur on the host, logging data is filtered, aggregated, and normalized at the host, then sent to the SIEM server for analysis and storage.
-   **Listener/collector**—rather than installing an agent, hosts can be configured to push updates to the SIEM server using a protocol such as syslog or SNMP. A process runs on the management server to parse and normalize each log/monitoring source.  
      
    Syslog ([tools.ietf.org/html/rfc3164](https://tools.ietf.org/html/rfc3164)) allows for centralized collection of events from multiple sources. It also provides an open format for event logging messages, and as such has become a de facto standard for logging of events from distributed systems. For example, syslog messages can be generated by Cisco routers and switches, as well as servers and workstations.
-   **Sensor**—as well as log data, the SIEM might collect packet captures and traffic flow data from sniffers. 

![Screenshot shows Asset (PFSENSE on 10.1.0.254), Type (OpenBSD PF Packet Filter), Plugin Enabled, and Instructions (Instruction to forward logs).](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/303-1599771805171.png)

Enabling a log parser plug-in for a pfSense security appliance so that firewall events can be imported into the SIEM. (Screenshot used with permission from AT&T Cybersecurity.)

### Log Aggregation 

Log aggregation refers to **normalizing data** from different sources so that it is **consistent and searchable**. SIEM software features connectors or plug-ins to interpret (or parse) data from distinct types of systems and to account for differences between vendor implementations. Usually parsing will be carried out using regular expressions tailored to each log file format to identify attributes and content that can be mapped to standard fields in the SIEM's reporting and analysis tools. Another important function is to normalize **date/time zone differences to a single timeline**.
# ANALYSIS AND REPORT REVIEW 

Where collection and aggregation produce inputs, a SIEM is also used for reporting. A critical function of SIEM—and the principal factor distinguishing it from basic log management—is that of correlation. This means that the [[SIEM]] software can link individual events or data points (observables) into a meaningful indicator of risk, or Indicator of Compromise ([[[[IoC]]]]). Correlation can then be used to drive an alerting system. These reports would be viewed from the SIEM dashboard.

Basic correlation can be performed using simple If…Then type rules. However, many SIEM solutions use artificial intelligence (AI) and machine learning as the basis for automated analysis.

### User and Entity Behavior Analytics

A user and entity behavior analytics ([[UEBA]]) solution supports identification of malicious behaviors from comparison to a baseline. As the name suggests, the analytics software tracks user account behavior across different devices and cloud services. **Entity refers to machine accounts, such as client workstations or virtualized server instances, and to embedded hardware, such as Internet of Things (IoT) devices**. The complexity of determining baselines and reducing false positives means that UEBA solutions are heavily dependent on AI and machine learning. Examples include Microsoft's Advanced Threat Analytics ([docs.microsoft.com/en-us/advanced-threat-analytics/what-is-ata](https://docs.microsoft.com/en-us/advanced-threat-analytics/what-is-ata)) and Splunk UEBA ([splunk.com/en_us/software/user-behavior-analytics.html](https://www.splunk.com/en_us/software/user-behavior-analytics.html)).

### Sentiment Analysis

One of the biggest challenges for behavior analytics driven by machine learning is to **identify intent**. It is extremely difficult for a machine to establish the context and interpretation of statements in natural language, though much progress is being made. The general efforts in this area are referred to as sentiment analysis, or **emotion AI**. The typical use case for sentiment analysis is to monitor social media for brand "incidents," such as a disgruntled customer announcing on Twitter what poor customer service they have just received. In terms of security, this can be used to gather threat intelligence and try to identify external or insider threats before they can develop as attacks. 

### Security Orchestration, Automation, and Response 

Security orchestration, automation, and response ([[SOAR]]) is designed as a solution to the problem of the volume of **alerts overwhelming analysts**' ability to respond. A SOAR may be implemented as a standalone technology or integrated with a [[SIEM]]—often referred to as a **next-gen SIEM**. The basis of SOAR is to scan the organization's store of security and threat intelligence, analyze #Ops it using machine/deep learning techniques, and then use that data to automate and provide data enrichment for the workflows that drive incident response and [[threat hunting]].
# FILE MANIPULATION

While SIEM can automate many functions of log collection and review, you may also have to manually prepare data using a [[Linux command line]].

### The cat Command

The Linux command cat allows you to **view** the contents of one or more files. For example, if you want to view the whole contents of two rotated log files, you could run:

cat -n access.log access2.log

The **-n switch** adds line numbers. If you wanted to output to a new file rather than the terminal, you can run:

cat -n access.log access2.log > access_cat.log

### The head and tail Commands

The **head and tail commands output the first and last 10 lines** respectively of a file you provide. You can also **adjust this default value to output more or fewer lines using the -n switch.** For example, the following command shows the 20 most recent entries in a log file:

tail /var/log/messages -n 20

### The logger Command

The **logger command writes input to the local system log or to a remote syslog server** ([linux.die.net/man/1/logger](https://linux.die.net/man/1/logger)). You can use the command in a script to write any text string or use the **-f option** to write the contents of another file. You can also write the output of commands by enclosing the command in **backticks**. The following command writes the name of the local machine along with the text "up" to the syslog server at 10.1.0.242:

logger -n 10.1.0.242 `hostname` up
# REGULAR EXPRESSIONS AND [[GREP]]

Filtering a log to discover data points of interest usually involves some sort of string search, typically invoking [[regular expression (regex) syntax]]. A regular expression is a search pattern to match within a given string. The search pattern is built from the regex syntax. This syntax defines metacharacters that function as search operators, quantifiers, logic statements, and anchors/boundaries. The following list illustrates some commonly used elements of regex syntax:

-   [ … ] matches a single instance of a character within the brackets. This can include literals, ranges such as [a-z], and token matches, such as [\s] (white space) or [\d] (one digit).
-   + matches one or more occurrences. A quantifier is placed after the term to match; for example, \s+ matches one or more white space characters.
-   * matches zero or more times.
-   ? matches once or not at all.
-   {} matches a number of times. For example, {2} matches two times, {2,} matches two or more times, and {2,5} matches two to five times.

A complete description of regex syntax is beyond the scope of this course, but you can use an online reference such as [regexr.com](https://regexr.com/) or [rexegg.com](http://rexegg.com/) to learn it.

The grep command invokes simple string matching or regex syntax to search text files for specific strings. This enables you to search the entire contents of a text file for a specific pattern within each line and display that pattern on the screen or dump it to another file. A simple example of grep usage is as follows:

grep -F 192.168.1.254 access.log

This searches the text file access.log for all lines containing some variation of the literal string pattern 192.168.1.254 and prints only those lines to the terminal. The -F switch instructs grep to treat the pattern as a literal.

The following example searches for any IP address in the 192.168.1.0/24 subnet using regex syntax for the pattern (note that each period must be escaped) within any file in any directory from the current one. The -r option enables recursion, while the period in the target part indicates the current directory:

grep -r 192\.168\.1\.[\d]{1,3} ./*
