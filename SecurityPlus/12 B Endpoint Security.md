---
tags: [implementation,section]
---
# EXAM OBJECTIVES COVERED

3.2 Given a scenario, [[implementation]] or #Implementation  host or application security solutions

Host hardware integrity is not of much use if the OS and applications software running on it is weakly configured. As a security professional, you will often assist with drafting configuration baselines, ensuring hosts comply with those baselines, and implementing [[endpoint]] protection security agents.
# HARDENING

The process of putting an operating system or application in a **secure configuration is called hardening**. When [[hardening]] a system, it is important to keep in mind its intended use, because hardening a system can also **restrict the system's access and capabilities**. The need for hardening must be balanced against the access requirements and usability in a particular situation.

For an OS functioning in a given role, there will usually be a fairly standard series of steps to follow to apply a secure configuration to allow the OS and applications software to execute that role. Many of the requirements can be applied automatically via a [[configuration baseline template]]. The **essential principle is of least functionality**; that a system should run only the protocols and services required by legitimate users and no more. This reduces the potential attack surface.

-   **Interfaces** provide a connection to the network. Some machines may have more than one interface. For example, there may be wired and wireless interfaces or a modem interface. Some machines may come with a management network interface card. If any of these interfaces are not required, they should be explicitly disabled rather than simply left unused.
-   **Services** provide a library of functions for different types of applications. Some services support local features of the OS and installed applications. Other services support remote connections from clients to server applications. Unused services should be disabled.
-   **Application service ports** allow client software to connect to applications over a network. These should either be disabled or blocked at a firewall if remote access is not required. Be aware that a server might be configured with a nonstandard port. For example, an Hyper Text Transfer ProtocolTTPs]] server might be configured to use 8080 rather than 80. Conversely, malware may try to send nonstandard data over an open port. An intrusion detection system should detect if network data does not correspond to the expected protocol format.
-   **Persistent storage holds** user data generated by applications, plus cached credentials. Disk encryption is essential to data security. Self encrypting drives can be used so that all data-at-rest is always stored securely.

It is also important to establish a maintenance cycle for each device and keep up to date with new security threats and responses for the particular software products that you are running.
# BASELINE CONFIGURATION AND REGISTRY SETTINGS 

You will have separate configuration baselines for desktop clients, file and print servers, Domain Name System (DNS) servers, application servers, directory services servers, and other types of systems. In Windows, configuration settings are stored in the registry. On a Windows domain network, each domain-joined computer will receive policy settings from one or more group policy objects (GPOs). These policy settings are applied to the registry each time a computer boots. Where hosts are centrally managed and running only authorized apps and services, there should be relatively little reason for security-relevant registry values to change. Rights to modify the registry should only be issued to user and service accounts on a least privilege basis. A host-based intrusion detection system can be configured to alert suspicious registry events.

Baseline deviation reporting means testing the actual configuration of hosts to ensure that their configuration settings match the baseline template. On Windows networks, the Microsoft Baseline Security Analyzer (MBSA) tool was popularly used to validate the security configuration. MBSA and other Microsoft reporting tools have now been replaced by the Security Compliance Toolkit ([docs.microsoft.com/en-us/windows/security/threat-protection/security-compliance-toolkit-10](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-compliance-toolkit-10)).

![Box has 5 sections: Summary, Settings that differ (16), Settings that match (12), Settings only in Baseline A (985), Settings only in Baseline B (0).](https://s3.amazonaws.com/wmx-api-production/courses/5731/images/3318-1599771807263.png)

Using Security Compliance Manager to compare settings in a production [[GPO]] with Microsoft's template policy settings. (Screenshot used with permission from Microsoft.)
# PATCH MANAGEMENT 

No operating system, software application, or firmware implementation is wholly free from [[vulnerability|vulnerabilities]]. As soon as a vulnerability is identified, vendors will try to correct it. At the same time, attackers will try to exploit it. **Automated vulnerability** scanners can be effective at **discovering missing patches** for the operating system, plus a wide range of third-party software apps and devices/firmware. Scanning is only useful if effective procedures are in-place to apply the missing patches, however.

On residential and small networks, hosts will be configured to auto-update, meaning that they check for and install patches automatically. The major OS and applications software products are well-supported in terms of vendor-supplied fixes for security issues. **Enterprise networks need to be cautious about this sort of automated deployment**, however, as a patch that is incompatible with an application or workflow can cause [[Availability]] issues. There can also be performance and management issues when multiple applications run update clients on the same host. For example, as well as the OS updater, there is likely to be a security software update, browser updater, Java updater, OEM driver updater, and so on. These issues can be mitigated by deploying an enterprise patch management suite. Some suites, such as Microsoft’s System Center Configuration Manager (SCCM)/Endpoint Manager ([docs.microsoft.com/en-us/mem/configmgr](https://docs.microsoft.com/en-us/mem/configmgr/)), are vendor-specific while others are designed to support third-party applications and multiple OSes.

It can also be difficult to schedule patch operations, especially if applying the patch is an [[Availability]] risk to a critical system. If vulnerability assessments are continually highlighting issues with missing patches, patch management procedures should be upgraded. If the problem affects certain hosts only, it could be an indicator of compromise that should be investigated more closely.

Patch management can also be difficult for legacy systems, proprietary systems, and systems from vendors without robust security management plans, such as some types of Internet of Things devices. These systems will need compensating controls, or some other form of risk mitigation if patches are not readily available.

Note that Linux systems patch management is accomplished from secure repositories managed by the distribution vendor. Custom applications are handled differently, and update repositories must be trusted.
# ENDPOINT PROTECTION

Another crucial step in hardening is to configure endpoint protection for automatic detection and prevention of malware threats. There have been many iterations of host-based/endpoint protection suites and agents. It is important to consider the **contrasting functions performed**, as individual software tools or protection suites often combine multiple functionality.

### Antivirus (A-V)/Anti-Malware

The first generation of antivirus ([[A-V]]) software is characterized by signature-based detection and prevention of known viruses. An "A-V" product will now perform generalized malware detection, meaning not just viruses and worms, but also Trojans, spyware, PUPs, cryptojackers, and so on. While A-V software remains important, signature-based detection is widely recognized as being insufficient for the prevention of data breaches.

### Host-Based Intrusion Detection/Prevention (HIDS/HIPS)

Host-based intrusion detection systems ([[HIDS]]) provide threat **detection via log and file system monitoring.** HIDS come in many different forms with different capabilities, some of them preventative (HIPS). File system integrity monitoring uses signatures to detect whether a managed file image—such as an OS system file, driver, or application executable—has changed. Products may also **monitor ports and network interfaces**, and process data and logs generated by specific applications, such as HTTPs]] or [[FTP]].

### Endpoint Protection Platform (EPP)

Endpoint protection usually depends on an agent running on the local host. If multiple security products install multiple agents (say one for A-V, one for HIDS, another for host-based firewall, and so on), they can impact system performance and cause conflicts, creating numerous technical support incidents and security incident false positives. An **endpoint protection platform** ([[EPP]]) is a single agent performing multiple security tasks, including malware/intrusion detection and prevention, but also other security features, such as a host firewall, web content filtering/secure search and browsing, and file/message encryption. 

### Data Loss Prevention (DLP)

Many EPPs include a data loss prevention (DLP) agent. This is configured with policies to identify privileged files and strings that should be kept private or confidential, such as credit card numbers. The agent enforces the policy to prevent data from being copied or attached to a message without authorization.

### Endpoint Protection Deployment

While specific products vary widely in terms of features and implementation detail, some generic tasks to implement endpoint protection include:

1.  **Configure** the management system to push the agent software and any updates to all desktops. This will require configuring permissions and firewall settings.
2.  **Assign** hosts to appropriate groups for policy assignment. For example, client endpoints have very different security requirements to servers. While it may be appropriate to use a preventative mechanism to immediately isolate a client when a threat is detected, automatically doing this for a critical server could cascade to loss of functionality across the network.
3.  Test the different **host group** configuration settings to ensure that the expected range of threats is detected.
4.  Use a **monitoring dashboard** to verify status across all network hosts. Apart from detection events, if the agent is disabled or missing, there should be an alert.
# NEXT-GENERATION ENDPOINT PROTECTION

Where EPP provides mostly signature-based detection and prevention, next-generation endpoint protection with automated response is focused on logging of endpoint observables and indicators combined with behavioral- and anomaly-based analysis.

### Endpoint Detection and Response (EDR)

An endpoint detection and response (EDR) product's aim is not to prevent initial execution, but to provide real-time and historical visibility into the compromise, contain the malware within a single host, and facilitate remediation of the host to its original state. The term EDR was coined by Gartner security researcher Anton Chuvakin, and Gartner produces annual "Magic Quadrant" reports for both EPP ([gartner.com/en/documents/3848470](https://www.gartner.com/en/documents/3848470)) and EDR functionality within security suites ([gartner.com/en/documents/3894086/market-guide-for-endpoint-detection-and-response-solutio](https://www.gartner.com/en/documents/3894086/market-guide-for-endpoint-detection-and-response-solutio)).

Where earlier endpoint protection suites report to an on-premises management server, next-generation endpoint agents are more likely to be managed from a cloud portal and use artificial intelligence (AI) and machine learning to perform user and entity behavior analysis. These analysis resources would be part of the security service provider's offering.

Note that managed detection and response (MDR) is a class of hosted security service ([digitalguardian.com/blog/what-managed-detection-and-response-definition-benefits-how-choose-vendor-and-more](https://digitalguardian.com/blog/what-managed-detection-and-response-definition-benefits-how-choose-vendor-and-more)).

### Next-Generation Firewall Integration

An analytics-driven next-gen antivirus product is likely to combine with the **perimeter** and **zonal security** offered by next-gen firewalls. For example, detecting a threat on an endpoint could automate a firewall policy to block the covert channel at the perimeter, isolate the endpoint, and mitigate risks of the malware using lateral movement between hosts. This type of functionality is set out in more detail in Sophos's white paper on **synchronized security** ([sophos.com/en-us/lp/synchronized-security.aspx](https://www.sophos.com/en-us/lp/synchronized-security.aspx)).
# ANTIVIRUS RESPONSE

An on-access antivirus scanner or intrusion prevention system works by **identifying when processes or scripts are executed and intercepting (or hooking) the call to scan the code first.** If the code matches a signature of known malware or exhibits malware-like behavior that matches a heuristic profile, the scanner will prevent execution and attempt to take the configured action on the host file (clean, quarantine, erase, and so on). An alert will be displayed to the user and the action will be logged (and also may generate an administrative alert). The malware will normally be tagged using a vendor proprietary string and possibly by a CME (Common Malware Enumeration) identifier. These identifiers can be used to research the symptoms of and methods used by the malware. This may help to confirm the system is fully remediated and to identify whether other systems have been infected. It is also important to trace the source of the infection and ensure that it is blocked to prevent repeat attacks and outbreaks.

### Advanced Malware Tools

Malware is often able to evade detection by automated scanners. Analysis of SIEM and intrusion detection logs might reveal suspicious network connections, or a user may observe unexplained activity or behavior on a host. When you identify symptoms such as these, but the AV scanner or EPP agent does not report an infection, you will need to analyze #Ops the host for malware using advanced tools.

There is a plethora of advanced analysis and detection utilities, but the starting point for most technicians is Sysinternals ([docs.microsoft.com/en-us/sysinternals](https://docs.microsoft.com/en-us/sysinternals/)).

### Sandboxing

Sandboxing is a technique that **isolates** an untrusted host or app in a segregated environment to conduct tests. [[Sandbox]] environments intentionally limit interfaces with the host environment. The analysis of files sent to a [[Sandbox]] can include determining whether the file is malicious, how it might have affected certain systems if run outside of the [[Sandbox]], and what dependencies it might have with external files and hosts. Sandboxes offer more than traditional anti-malware solutions because you can apply a variety of different environments to the [[Sandbox]] instead of just relying on how the malware might exist in your current configuration.
